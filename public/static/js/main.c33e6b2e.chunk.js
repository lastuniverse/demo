(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{10:function(e,t,n){e.exports=n(20)},15:function(e,t,n){},19:function(e,t){window.setImmediate||(window.setImmediate=function(){var e={},t=e,n=Math.random();function r(t){if(t.data===n){var r=(e=e.next).func;delete e.func,r()}}return window.addEventListener?window.addEventListener("message",r):window.attachEvent("onmessage",r),function(e){t=t.next={func:e},window.postMessage(n,"*")}}())},20:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(2),o=n(4),i=n(3),c=n(0),s=n.n(c),u=n(7),l=n.n(u),f=(n(15),n(9)),m=new(function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e,a){var o;return Object(r.a)(this,n),(o=t.call(this)).url=e,o.timeout=0,o.__timeout=a||3e4,o.ca\u0441he=[],o.isConnect=!1,o.connect(),o}return Object(a.a)(n,[{key:"init",value:function(){var e=this;setTimeout((function(){console.log("\u041f\u044b\u0442\u0430\u044e\u0441\u044c \u043f\u0435\u0440\u0435\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a",e.url),e.connect()}),this.timeout)}},{key:"connect",value:function(){var e=this;this.connection&&this.connection.close(),this.connection=new WebSocket(this.url),this.connection.on=function(t,n){e.connection["on"+t]=n},this.connection.on("error",(function(t){e.isConnect=!1,console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f:",t),e.init()})),this.connection.on("close",(function(){e.isConnect=!1,console.log("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c"),e.init()})),this.connection.on("open",(function(){e.timeout=e.__timeout,e.isConnect=!0,e.emit("connection"),console.log("\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f \u043a",e.url),e.ca\u0441he.forEach((function(t){e.connection.send(t)})),e.ca\u0441he=[]})),this.connection.on("message",(function(t){try{var n=JSON.parse(t.data);if(!n.action)return;e.emit.apply(e,[n.action].concat(Object(f.a)(n.data)))}catch(r){}}))}},{key:"send",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a={action:e,data:n},o=JSON.stringify(a);this.isConnect&&this.connection?this.connection.send(o):this.ca\u0441he.push(o)}}]),n}(n(8).a))("ws://lastuniverse.ru:80/cluster",5e3),h=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).messages=[],a.state={display:"none"},m.send("worker.getfullinfo"),m.on("message",(function(e){a.messages.push(e),setTimeout((function(){a.messages.shift()}),5e3),a.show(e),clearTimeout(a.timer),a.timer=setTimeout((function(){a.hide()}),3e3)})),a}return Object(a.a)(n,[{key:"renderMessage",value:function(e,t){return s.a.createElement("p",{key:t},e)}},{key:"renderMessages",value:function(){var e=this;return this.messages.join(""),this.messages.map((function(t,n){return e.renderMessage(t,n)}))}},{key:"show",value:function(e){this.setState({display:"flex"})}},{key:"hide",value:function(){this.setState({display:"none"})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"modal",style:{display:this.state.display}},this.renderMessages(),s.a.createElement("button",{className:"modal-button",onClick:function(){return e.hide()}},"\u2716"))}}]),n}(s.a.Component),d=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){return Object(r.a)(this,n),t.call(this,e)}return Object(a.a)(n,[{key:"kill",value:function(e){m.send("worker.kill",this.props.worker.pid)}},{key:"renderButton",value:function(){var e=this;return this.props.worker.alive?s.a.createElement("button",{className:"worker-button",onClick:function(){return e.kill()}},"\u0443\u0431\u0438\u0442\u044c"):s.a.createElement("div",{className:"worker-button"},"\u043c\u0435\u0440\u0442\u0432")}},{key:"render",value:function(){return s.a.createElement("div",{className:"worker"},s.a.createElement("div",{className:"worker-info"},"status: ",s.a.createElement("b",null,this.props.worker.status)),s.a.createElement("div",{className:"worker-info"},"pid: ",s.a.createElement("b",null,this.props.worker.pid)),s.a.createElement("div",{className:"worker-info"},s.a.createElement("b",null,this.props.worker.generated)," / ",s.a.createElement("b",null,this.props.worker.processed)),this.renderButton())}}]),n}(s.a.Component),v=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(a.a)(n,[{key:"fork",value:function(){m.send("worker.fork",!0)}},{key:"killall",value:function(){m.send("worker.killall",!0)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"cluster-controls"},s.a.createElement("button",{className:"control-button",onClick:function(){return e.fork()}},"\u043d\u043e\u0432\u044b\u0439 \u0432\u043e\u0440\u043a\u0435\u0440"),s.a.createElement("button",{className:"control-button",onClick:function(){return e.killall()}},"\u0443\u0431\u0438\u0442\u044c \u0432\u0441\u0435 \u0432\u043e\u0440\u043a\u0435\u0440\u044b"))}}]),n}(s.a.Component),k=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={workers:{},info:{generated:0,processed:0}},m.on("worker.list",(function(e){a.setState({workers:e})})),m.on("cluster.info",(function(e){a.setState({info:e})})),m.on("connection",(function(e){m.send("worker.getlist",!0)})),a}return Object(a.a)(n,[{key:"renderWorker",value:function(e){return s.a.createElement(d,{key:e.pid,worker:e})}},{key:"renderWorkerList",value:function(){var e=this;return Object.values(this.state.workers).map((function(t){return e.renderWorker(t)}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"cluster"},s.a.createElement("div",{className:"cluster-info"},this.state.info.generated," / ",this.state.info.processed),s.a.createElement("div",{className:"workers-list"},this.renderWorkerList()),s.a.createElement(v,null))}}]),n}(s.a.Component),p=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return s.a.createElement("div",{className:"main"},s.a.createElement("div",{className:"block-left"},s.a.createElement(k,null)),s.a.createElement("div",{className:"block-right"}),s.a.createElement("div",null,s.a.createElement(h,null)))}}]),n}(s.a.Component);l.a.render(s.a.createElement(p,null),document.getElementById("root"))},8:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n(1),a=n(2),o=(n(19),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"async";Object(r.a)(this,t),this.m=e,this.e={}}return Object(a.a)(t,[{key:"on",value:function(e,t){return"object"!==typeof this.e[e]&&(this.e[e]=[]),this.e[e].push(t),t}},{key:"removeListener",value:function(e,t){var n=this.e[e];if("object"===typeof n){var r=n.indexOf(t);r<0||(n.splice(r,1),n.length||delete this.e[e])}}},{key:"emit",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var o=this.e[t];"object"===typeof o&&("sync"===this.m?o.forEach((function(e){return e.apply(void 0,r)})):o.forEach((function(t){return e((function(){return t.apply(void 0,r)}))})))}},{key:"once",value:function(e,t){var n=this;return this.on(e,(function r(){n.removeListener(e,r),t.apply(void 0,arguments)})),t}}]),t}())}).call(this,n(16).setImmediate)}},[[10,1,2]]]);
//# sourceMappingURL=main.c33e6b2e.chunk.js.map